'use strict';

/*! [PROJECT_NAME] | Suitmedia */

(function (window, document, undefined) {

    var path = {
        css: myPrefix + 'assets/css/',
        js: myPrefix + 'assets/js/vendor/'
    };

    var assets = {
        _objectFit: path.js + 'object-fit-images.min.js',
        _headroom: path.js + 'headroom.min.js',
        _slick: path.js + 'slick.min.js'
    };

    var slickPrev = '<button type="button" class="slick-prev"><span class="fa fa-angle-left"></span></button>';
    var slickNext = '<button type="button" class="slick-next"><span class="fa fa-angle-right"></span></button>';

    var Site = {
        enableActiveStateMobile: function enableActiveStateMobile() {
            if (document.addEventListener) {
                document.addEventListener('touchstart', function () {}, true);
            }
        },
        WPViewportFix: function WPViewportFix() {
            if ('-ms-user-select' in document.documentElement.style && navigator.userAgent.match(/IEMobile/)) {
                var style = document.createElement('style');
                var fix = document.createTextNode('@-ms-viewport{width:auto!important}');

                style.appendChild(fix);
                document.head.appendChild(style);
            }
        },
        objectFitPolyfill: function objectFitPolyfill() {
            load(assets._objectFit).then(function () {
                objectFitImages();
            });
        },
        bannerSlider: function bannerSlider() {
            var slider = $('.section-intro');

            if (!slider.length) return;
            //cek jika tidak ada element pada saat load page, tidak perlu
            //menjalankan fungsi modernizr
            Modernizr.load({
                load: assets._slick,
                complete: function complete() {
                    slider.slick({
                        prevArrow: slickPrev,
                        nextArrow: slickNext,
                        dots: true
                    });
                }
            });
        }
    };

    Promise.all([
        // load(assets._assets)
    ]).then(function () {
        for (var fn in Site) {
            Site[fn]();
        }
        window.Site = Site;
    });

    function exist(selector) {
        return new Promise(function (resolve, reject) {
            var $elem = $(selector);

            if ($elem.length) {
                resolve($elem);
            } else {
                reject('no element found for ' + selector);
            }
        });
    }

    function load(url) {
        return new Promise(function (resolve, reject) {
            Modernizr.load({
                load: url,
                complete: resolve
            });
        });
    }

    function loadJSON(url) {
        return new Promise(function (resolve, reject) {
            fetch(url).then(function (res) {
                if (res.ok) {
                    resolve(res.json());
                } else {
                    reject('Network response not ok');
                }
            }).catch(function (e) {
                reject(e);
            });
        });
    }
})(window, document);